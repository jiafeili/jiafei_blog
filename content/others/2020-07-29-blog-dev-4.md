---
title: 开发日志[4]--用 Hugo + Netlify 重新建站
date: 2020-07-29T15:38:04-05:00
tags:
- blog-development
comments: true
---

网站开了几年了，没写几篇文章，论原因的话忙和懒各占一半。最近腾出点时间，把网站用Hugo重新搭了一下，转到了Netlify上面。这么做也没啥特别的理由，主要是原来的网页设计有点看腻了。这个过程我一开始以为会很简单，不过还是多少折腾了一会儿。

首先当然就是把文章转移出来。这个我用的是自带的`hugo import jekyll`，没什么问题。

接下来，我用最快的方法建了个新站，然后很单纯地把所有内容复制到原来Github Pages那个文件夹，以为这样就搞定了。后来看网站怎么也刷不出来，采取查了一下 —— 原来 Github Pages 使用的是 Jekyll，换 Hugo 的话接着用GP比较麻烦，大家都建议用 Netlify。唉，怎么不早说，早说我就不换了。不过事已至此了，还是赶紧继续吧。

Netlify 可以直接从Github repo里面同步，特别方便。唯一问题是原来github.io的后缀不能用了，我也没买域名，就用了自带的netlify.app，基本是出于薅羊毛的心态。这过程就开始出现问题了，一开始 Netlify deploy 不出来网页，总是各种报错，后来创建了个`netlify.toml`文件，里面把 Hugo version改了一下：

```toml
[context.production.environment]
 HUGO_VERSION = "0.74.0"
```

这样改完网站倒是出来了，但是没有CSS，主题好像不能加载。不知道问题是啥，网上也是众说纷纭的，主流的说法是因为主题下载的时候应该用`git submodule` 而不是 `git clone` ，否则Netlify不能兼容。但是我依样画葫芦试了半天也不行。心情非常烦躁。

最后我查了半天，发现是低级错误：`baseURL` 那里我`https://`写成了`http://` —— 无语，没想到输在了这里。改完以后就可以看到排版了。

我的模板是从这个 [仙人掌](https://github.com/monkeyWzr/hugo-theme-cactus) 改的，把`blockquote`部分弄得正常了一点，尤其是把那个不符合我审美的绿色给改了。说到这不得不吐槽一句，为什么好多模板都把`blockquote`写得这么夸张，好像引的都是什么名言佳句一样，还要单独用超大的字体，超居中的排版，明晃晃的引号或者什么别的图案，显示出这句话的与众不同 —— 而大多数时候，我们引用什么，不都是为了佐证我们自己要说的话吗？

当然这个设计我还是不太满意。一那个网页Logo还没换，用的还是原来主题自带的仙人掌；二是文章页标题和Tag离得太近，加点空间比较好；最后就是如果一篇文章有超过三个标签（tags），那么从第三个开始，所有的标签都会变成用逗号隔开，而不是像前两个一样用空格隔开。都是一些零星的小问题，等有工夫的时候慢慢解决。

最后当然还有一些小工作，比如把文章分类， 把Disqus讨论区放进来，等等。有个事我没搞明白，就是怎么把原来网站的评论引到现在的网站。我试了Disqus自带的“url-mapping”，上传了一个csv上去。一会儿Disqus邮件告诉我传输完毕了，但是评论就是死活不挪窝，让人非常郁闷。虽然原来的网站也没几条评论，不过还是能转过来最好 —— 这个有待继续研究。

差点忘了，还有回头得加一个文件，能够允许用户用键盘翻页，这个在上一篇开发日志里有具体的教程。

